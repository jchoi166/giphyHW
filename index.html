<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Giphy API</title>
    <link href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB'
        crossorigin='anonymous'>
    <style>
        img{
            width: 200px;
            height: 200px;
        }
    </style>
</head>

<body>

    <div class="container-fluid">
        <div class="row">
            <div id="categories"></div>
        </div>

        <div class="row">
            <div class="col-md-6 d-flex flex-wrap" id="images-view"></div>
            <div class="col-md-6">
                <form id="game-form">
                    <label for="game-input"> Add a game! </label>
                    <input type="text" id="game-input">
                    <br>
                    <input id="add-game" type="submit" value="Add a game!">
                </form>
            </div>
        </div>

    </div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


        var vgArray = ["Fortnite", "PUBG", "CS:GO", "Rainbow Six: Seige", "League of Legends", "Dota 2", "World of Warcraft", "Overwatch"]

//~~~~~~~~~~~~~~~~~~~~ Creating Buttons ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//
        function createButtons() {

            $("#categories").empty()

            vgArray.forEach(function (i) {
                var a = $("<button>");
                a.addClass("game-button");
                a.attr("data-name", i);
                a.text(i);
                $("#categories").append(a);
            })
        }

//~~~~~~~~~~~~~~~~~~~~ Displaying Info ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//
        function displayInfo() {
            var apiKey = "ZhJNzy2HIqWs1nGPBf5FzBUmtU7OZvif"
            var game = $(this).attr("data-name")
            var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + game + "&limit=10&api_key=" + apiKey


            $.get(queryURL)

                .then(function (r) {
                    console.log(r.data)
                    r.data.forEach(function (d) {

                        var movieDiv = $("<div class='game m-2' id= 'image-toggler'>");
                        var rated = d.rating;
                        var pOne = $("<p>").text("Rating: " + rated);                 
                        movieDiv.append(pOne);        
                        
                        var imgURL = d.images.fixed_height_still.url;
                        var gifURL = d.images.original.url;   
                                
                        var stillImage = $("<img>").attr("src", imgURL);  
                        var gifImage = $("<img style='display:none'>").attr("src", gifURL);  

                        movieDiv.append(stillImage);
                        movieDiv.append(gifImage);

                        $("#images-view").prepend(movieDiv);
                    })


                })
                .catch(function (e) {
                    console.log("Error")
                    console.log(e)
                })

        }

//~~~~~~~~~~~~~~~~~~~ Buttons for Displaying Info and Toggling Images ~~~~~~~~~~~~~~~~~~``//
        $("#add-game").on("click", function (event) {
            event.preventDefault();
            var movie = $("#game-input").val().trim();
            vgArray.push(movie);
            createButtons();

        });

        $(document).on("click", ".game-button", displayInfo);
        $(document).on("click", "#image-toggler", function(){
            $(this).find('img').toggle()
        })

        createButtons()
    </script>

</body>

</html>