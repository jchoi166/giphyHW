<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Giphy API</title>
    <link href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB'
        crossorigin='anonymous'>
    <style>
        img{
            width: 200px;
            height: 200px;
        }
    </style>
</head>

<body>

    <div class="container-fluid">
        <div class="row">
            <div id="categories"></div>
        </div>

        <div class="row">
            <div class="col-md-6 d-flex flex-wrap" id="images-view"></div>
            <div class="col-md-6">
                <form id="game-form">
                    <label for="game-input"> Add a game! </label>
                    <input type="text" id="game-input">
                    <br>
                    <input id="add-game" type="submit" value="Add a game!">
                </form>
            </div>
        </div>

    </div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


        var vgArray = ["Fortnite", "PUBG", "CS:GO", "Rainbow Six: Seige", "League of Legends", "Dota 2", "World of Warcraft", "Overwatch"]

        function createButtons() {

            $("#categories").empty()

            vgArray.forEach(function (i) {
                var a = $("<button>");
                a.addClass("game-button");
                a.attr("data-name", i);
                a.text(i);
                $("#categories").append(a);
            })
        }
        function displayInfo() {
            var apiKey = "zeKh1hQY0TDUN2mZFRJkmePDHKRO27kD"
            var game = $(this).attr("data-name")
            var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + game + "&limit=10&api_key=" + apiKey


            $.get(queryURL)

                .then(function (r) {
                    r.data.forEach(function (d) {
                        // Creating a div to hold the movie
                        var movieDiv = $("<div class='game m-2'>");

                        // Storing the rating data
                        var rated = d.rating;

                        // Creating an element to have the rating displayed
                        var pOne = $("<p>").text("Rating: " + rated);

                        // Displaying the rating
                        movieDiv.append(pOne);

                        // Retrieving the URL for the image
                        var imgURL = d.images.original.url;

                        // Creating an element to hold the image
                        var image = $("<img>").attr("src", imgURL);

                        // Appending the image
                        movieDiv.append(image);

                        // Putting the entire movie above the previous movies
                        $("#images-view").prepend(movieDiv);
                    })


                })
                .catch(function (e) {
                    console.log("Error")
                    console.log(e)
                })

        }

        $("#add-game").on("click", function (event) {
            event.preventDefault();
            // This line grabs the input from the textbox
            var movie = $("#game-input").val().trim();

            // Adding movie from the textbox to our array
            vgArray.push(movie);

            // Calling renderButtons which handles the processing of our movie array
            createButtons();
        });

        $(document).on("click", ".game-button", displayInfo);


        createButtons()
    </script>

</body>

</html>